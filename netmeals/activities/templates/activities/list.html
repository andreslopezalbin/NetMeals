{% extends 'masterpage/masterpage.html' %}
{% load staticfiles %}
{% load crispy_forms_tags %}
{% crispy form form.helper %}
{% load activities_extra %}

{% block title %}List of Activities{% endblock %}
{% block content %}

    {% if subscription_succeeded %}
        <div class="container alerts">
            <div class="alert alert-success alert-dismissable">
                <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
                <strong>{{success_msg}}</strong>
            </div>
        </div>
    {% endif %}

     {% if unsubscription_succeeded %}
        <div class="container alerts">
            <div class="alert alert-success alert-dismissable">
                <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
                <strong>{{success_msg}}</strong>
            </div>
        </div>
    {% endif %}

    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <div class="row">
                    {% for activity in activities %}
                        <a href="{% url "activity_detail" activity.id %}">
                            <div class="col-md-4">
                                <div class="thumbnail">
                                    <img alt="{{ activity.name }}"
                                         src="{{ activity.photo }}" style="width:90% ; border-radius: 5% "/>
                                    <div class="caption">
                                        <h3>
                                            {{ activity.name }}
                                        </h3>
                                        <p>
                                            {{ activity.description }}
                                        </p>
                                        <p>
                                            {% if user.is_authenticated %}
                                                {% if request.user|is_subscribed:activity.id  %}
                                                    <a class="btn btn-primary" href="{% url "activity_unsubscribe" activity.id %}">Unsubscribe</a>
                                                {% else %}
                                                    <a class="btn btn-primary" href="{% url "activity_subscribe" activity.id %}">Subscribe!</a>
                                                {% endif %}
                                            {% endif %}
                                            {% if activity.owner.id == user.id %}
                                                <a class="btn"href="{% url "activity_edit" activity.id %}">Edit</a>
                                            {% endif %}
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </a>
                    {% endfor %}

                </div>
            </div>
        </div>
    </div>
<script type="text/javascript">
   $(".alert").fadeTo(3000, 500).slideUp(500, function(){
        $(".alert").slideUp(500);
    });
</script>
{% endblock %}